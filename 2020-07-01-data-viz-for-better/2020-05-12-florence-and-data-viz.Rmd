---
title: "Data Viz for better"
subtitle: " RSS Merseyside"
author: '`r jrPresentation::get_author()`'
date: '2020-07-01'
output:
  xaringan::moon_reader:
    css: ["default", "ninjutsu", "style.css"]
    lib_dir: libs
    nature:
      ratio: 16:10
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE, message=FALSE}
options(htmltools.dir.version = FALSE)
library("jrPresentation")
knitr::opts_chunk$set(fig.width = 8, message = FALSE, warning = FALSE, comment = "", cache = FALSE, fig.retina = 3, echo = FALSE)
library(flipbookr)
library(tidyverse)
library(HistData)
library(lubridate)
```

layout: true

---
```{r tote}
knitr::include_graphics(path = "graphics/tote-zoom.jpg")
```
???
* I find myself looking at Florence's polar area diagram - atleast once a week.
* If you see me in Aldi, or come to my house for a cuppa, you might think I'm a bit weird.


---
```{r crazy}
knitr::include_graphics(path = "graphics/crazy-lady.jpg")
```

???

* I have a large collection of FN paraphilania.
* I might open a FN museum of the North
* Florence Nigtingale Day started in 2013, run by Professor Nadia Mazda & Lancaster M&S dep
* Statistician & Nurse. I would argue she was also a communicator - which is a key part of both.


---

layout: true
`r add_border()`

---

# Why do we make plots?


* Pretty - make Art
* Get published
* Tell a story
* Educate
* Clickbate
* Make a difference 
* Inspire change
???

* Florence made plots to tell a story 

---

# How can graphics make a difference?

* ACTION
* Challenger disaster
https://bookdown.org/egarpor/PM-UC3M/glm-challenger.html
* evidence-based healthcare

FN: Asking the right questions - What make a good graph(before the plot)
FN: Organise correctly - to make comparisons

---

# Challenger disaster

• Launch Time: January 28, 1986
• The temperature was 31◦F / -0.5 C
• Exploded after 73 seconds from its launch leading to the death of its seven crew
members

Each rocket-booster has three joints called O-rings (6 total)

• The night before the scheduled launch, discussions occurred as to whether the
launch should be postponed because of the low temperature
• It was believed, by some of the people who were involved in the decision, that
low temperatures might harden the O-ring seals, and thus leading to a potentially
dangerous combustion-gas leak
• The O-rings had been designated as a ”Criticality 1” component
• The engineers and manufacturers of the rocket motors believed that they should
abort the flight
• They presented several (hand written) tabulated numbers to show their point.
The following figure was taken from Tufte (1997):

```{r}
data_url = "http://www.math.usu.edu/~symanzik/teaching/2009_stat6560/RDataAndScripts/sharif_abbass_project1_challenger.csv"

challenger = readr::read_csv(url(data_url))

challenger %>%
  ggplot(aes(x = temperature, y = r)) + 
  geom_point() + 
  geom_smooth(method = "gam", se = FALSE) +
  xlim(20, 80) + 
  ylim(0, 6) +
  geom_vline(xintercept = 31, lty = 2) +
  hrbrthemes::theme_ipsum()
```

---

# Victoria Viz


[Explore!](https://history.infowetrust.com/)
[Milestones](http://datavis.ca/milestones/index.php)

Golden Age of Statistics: https://projecteuclid.org/download/pdfview_1/euclid.ss/1242049392
Graphcs: https://archive.org/details/mortalityofbriti00lond/page/n33/mode/2up

???
* Minard,
* John Snow - Cholera
* Tables more common, graphics not seen as usfeul (cite)


* Florence "printed Tables & all in double columns I do not think anyone will read it. None but scientific men ever look in the Appendix of a Report. And this is for the vulgar public."


---

layout: true

---


background-image: url(graphics/playfair.jpg)
background-size: contain 
class: center, middle, inverse

???

Scottish-born William Playfair
Invented of the pie chart, and circle graph, used to show part-whole relations
http://www.branchcollective.org/?ps_articles=jonathan-sachs-17861801-william-playfair-statistical-graphics-and-the-meaning-of-an-event

---

background-image: url(graphics/guerry_1829-coxcombs.jpg)
background-size: contain 
class: center, middle, inverse

???

* André-Michel Guerry (1829)
* French lawyer and amateur statistician.
* Show variations in weather and other phenomena over calendar cycles.
* Variation of the pie chart
* uses equi-angular sectors of differing radii
* rather than sectors with varying angle, but equal radii
* direction of the wind in 8 sectors
* births and deaths by hour of theday.

* Nightingale probably got the idea from William Farr, who in turn was acquainted with Guerry's work.

---

background-image: url(graphics/liverpool-rose.png)
background-size: contain 
class: center, middle

---

background-image: url(graphics/classic-wedge-2.jpeg)
background-size: contain 
class: center, middle, inverse

???

* Name (rose, polar area, wedges)
* Coxcombe - not the name - pampleft - she self-publisised go girl!
* Describe it visually
* Worked with Dr William Farr(Medical Statistician)
* Covid-collateral damage 

Nightingale hoped her charts would liven up her publications; the queen, she thought, might look at the pictures, even if she did not read the words.

---

layout: true

`r add_border()`

---


```{r, echo=F}
knitr::opts_chunk$set(fig.width = 18, fig.height = 10, fig.align = 'center')
```



```{r bar}
HistData::Nightingale %>% 
  mutate(Month = str_to_upper(month((HistData::Nightingale$Date), label = TRUE, abbr = FALSE))) %>% 
  mutate(When = if_else(Year == 1854 | (Year == 1855 & Month %in% c("JANUARY", "FEBRUARY", "MARCH")),
                        "1. \n APRIL 1854 TO MARCH 1855",
                        "2. \n APRIL 1855 TO MARCH 1856"))  %>%
  mutate(angle = rep(90 - seq(15, 345, by = 30), times = 2)) %>%
  mutate(text_pos = if_else(Disease.rate > 120,
                            Disease.rate,
                            120)) %>%
  pivot_longer(cols = ends_with("rate"),  names_to = "Cause", values_to = "Deaths")  %>%
  mutate(Label = if_else(Cause == "Disease.rate", as.character(Month), "")) %>%
  mutate(Month = factor(Month,  levels = c("APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER", "JANUARY", "FEBRUARY", "MARCH"))) %>%
ggplot() +
  aes(x = Month) + 
  aes(y = Deaths) + 
  geom_col(width = 1, alpha = 0.9, position = "identity", col = "white") + 
  facet_wrap(~When) + 
  aes(fill = Cause, col = Cause) + 
  scale_fill_manual(values = c("Wounds.rate" = "red",#"#e7bebc",
                               "Other.rate" = "#322b2f",
                               "Disease.rate" = "lightblue")) + 
  scale_colour_manual(values = c("Wounds.rate" = "#e7bebc",
                                 "Other.rate" = "grey",
                                 "Disease.rate" = "lightblue")) +
  theme_minimal()  +
  theme(plot.title = element_text(hjust = 0.5, family = "serif", size = 18), 
        plot.subtitle = element_text(hjust = 0.5, size = 14, family = "Times New Roman"),
        plot.caption = element_text(hjust = 0, size = 10, family = "serif", face = "italic")) + 
  theme(panel.spacing = unit(0, "lines")) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  theme(text = element_text(size = 24))
```

???

* Why didn’t she make a column chart?
* Compare year on year (cyclic)
* Compare season on season
* Stand out from the rest (many bar charts)
* Which tells the better story?


```{r, bar_data}
df = tibble::tibble(category = c("A", "B", "C"),
                    value = c(1, 3, 2))
```

```{r, echo = FALSE}
knitr::opts_chunk$set(fig.width = 18, fig.height = 10, fig.align = "center")
```


```{r, bar2polar}
ggplot(df) + 
  theme_minimal() +
  theme(text = element_text(size = 24)) +
  aes(x = category) +
  aes(y = value) +
  geom_col(width = 1) + 
  aes(fill = category) + 
  coord_polar() +
  scale_y_sqrt()
```


---

`r chunk_reveal("bar2polar")`

---

# The Rose is mightier than the Pie...?

1. Each slice is an equal sector
1. Each slice allows area comparison with other slices
1. Good for cyclic phenomia (direction + volume)
1. Easier to compare radii than angles
1. Suits small multiples

???

* Originally Batwing but FN was worried misinterpretted.

The length of the radial line in each month is proportional to the death rate, but both the text and the appearance imply that it is the shaded area that is proportional to the death rate, rather than the length of the radial lines. Florence recognised this error and inserted an erratum slip, but then replaced this diagram in later documents (nos. 3, 4, and 5 listed above)

---

# Opinions

> The diagrams improve on pie charts in exchange for a greater difficulty of reading. As is the case for pie charts, the inherent problem is the difficulty of making good comparisons across the wedges. In general, for such small data sets, tables will outperform graphics.

-- Edward Tufte

* Is it wrong to be enraged by a graph - LL
* The graph conceals parts of the data, misrepresents quantity by area, and what is worst of all, *requires explanation*.

---

# Area / stacked

Most of the graphics used in Nos. 1 and 2 are similar to those previously used by her adviser William Farr in his Registrar-General's Annual Reports.  They are mostly what we might call '100% area' or '100% stacked bar':  Lord Herbert bar chart

---

# Honeycomb

There is also one 'honeycomb' graphic showing how densely soldiers are packed in camp (a device which Farr had already used for illustrating urban density), and two other graphics that are highly original.  

---

# Lines

The other highly original chart is what I will call the 'Lines' - a bar chart showing how soldiers in peacetime, living in their barracks in England, were dying at a faster rate than civilians in the cities around them.

---

# Re-creating in R

* Data available in the R pacakge **HistData**


```{r histdata}
kableExtra::kable(HistData::Nightingale)
```

```{r polartransform, echo = FALSE, eval = TRUE}
HistData::Nightingale %>% 
  mutate(Month = str_to_upper(month((HistData::Nightingale$Date), label = TRUE, abbr = FALSE))) %>% 
  mutate(When = if_else(Year == 1854 | (Year == 1855 & Month %in% c("JANUARY", "FEBRUARY", "MARCH")),
                        "1. \n APRIL 1854 TO MARCH 1855",
                        "2. \n APRIL 1855 TO MARCH 1856"))  %>%
  mutate(angle = rep(90 - seq(15, 345, by = 30), times = 2)) %>%
  mutate(text_pos = if_else(Disease.rate > 120,
                            Disease.rate,
                            120)) %>%
  mutate(When = factor(When, levels = c("2. \n APRIL 1855 TO MARCH 1856",  "1. \n APRIL 1854 TO MARCH 1855"))) %>%
  pivot_longer(cols = ends_with("rate"),  names_to = "Cause", values_to = "Deaths")  %>%
  mutate(Label = if_else(Cause == "Disease.rate", as.character(Month), "")) %>%
  mutate(Month = factor(Month,  levels = c("APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER", "JANUARY", "FEBRUARY", "MARCH"))) -> 
  polar_data
```


```{r, echo = FALSE}
knitr::opts_chunk$set(fig.width = 20, fig.align = "center")
```


```{r, polarplot, eval = TRUE}
ggplot(polar_data) +
  aes(x = Month) + 
  aes(y = Deaths) + 
  geom_col(width = 1, alpha = 0.3, position = "identity") + 
  theme(text = element_text(size = 24)) +
  facet_wrap(~When) + 
  aes(fill = Cause, col = Cause) + 
  coord_polar(start = -pi/2, clip = "off") +
  scale_y_sqrt() +
  geom_text(aes(label = Label, y = text_pos, angle = angle),
            position = "identity", color = "black",
            size = 5, vjust = -1.5) +
  labs(title = "DIAGRAM OF THE CAUSES OF MORTALITY",
       subtitle = "IN THE ARMY IN THE EAST") +
  xlab("") + 
  scale_fill_manual(values = c("Wounds.rate" = "red",#"#e7bebc",
                               "Other.rate" = "#322b2f",
                               "Disease.rate" = "lightblue")) + 
  scale_colour_manual(values = c("Wounds.rate" = "#e7bebc",
                                 "Other.rate" = "grey",
                                 "Disease.rate" = "lightblue")) +
  theme_void()  +
  theme(legend.position = "none") + 
  theme(plot.title = element_text(hjust = 0.5, family = "serif", size = 36), 
        plot.subtitle = element_text(hjust = 0.5, size = 30, family = "Times New Roman"),
        plot.caption = element_text(hjust = 0, size = 10, family = "serif", face = "italic")) + 
  theme(panel.spacing = unit(-15, "lines")) +
  labs(caption =  "The Areas of the blue, red, & black wedges are each measured from \n   the centre as the common vertex.
The blue wedges measured from the centre of the circle represent area \n   for area the deaths from Preventable or Mitigable Zymotic diseases, the \n   red wedges measured from the centre the deaths from wounds, & the \n   black wedges measured from the centre the deaths from all other causes.
The black line across the red triangle in Nov. 1854 marks the boundary \n   of the deaths from all other causes during the month.
In October 1854, & April 1855, the black area coincides with the red, \n   in January & February 1856, the blue coincides with the black.
The entire areas may be compared by following the blue, the red, & the \n   black lines enclosing them.")
```

---

layout: true

---

`r chunk_reveal("polartransform", break_type = "auto")`

---

`r chunk_reveal("polarplot", break_type = "auto", display_type = "output")`

---

layout: true

`r add_border()`

---

# StatsYSS #FloViz competition


.pull-left[
```{r gunning}
knitr::include_graphics(path = "graphics/gunning.jpg")
```

* [Most accurate: Edward Gunning](https://github.com/edwardgunning/FlorenceNightingale)
* [Full results](https://statsyss.wordpress.com/2020/05/13/floviz-winning-entries/)

]

.pull-right[
```{r athena}
knitr::include_graphics(path = "graphics/athena.jpg")
```


]

???

Nandita Das for her beautiful version of the diagram in the shape of Athena, Flo’s pet owl


---

# Modern Polar Area Graphs

https://www.theguardian.com/world/interactive/2012/may/08/gay-rights-united-states
http://measure.fathom.info/
http://www.storytellingwithdata.com/blog/2019/7/15/recapping-radials

---
layout: true
---
```{r}
# Run data
df = readRDS("all_activies.RDS")

# Run activity count
run_rose = 
  df %>%
  mutate(month = month(start_date, label = TRUE),
         year = year(start_date))  %>%
  filter(type == "Run") %>%
  group_by(month, year) %>%
  summarise(total_runs = n()) %>%
  mutate(label = if_else((month == "Dec" & year == 2015) |
                           (month == "Jul" & year == 2015) |
                           (month == "Sep" & year == 2015) |
                           (month == "Jan" & year == 2020) |
                           (month == "Apr" & year == 2020) |
                           (month == "Jun" & year == 2020),
                         glue::glue("{month} {year}"),
                         ""))

run_rose$hjust = 0
run_rose$vjust = 0

run_rose$hjust[run_rose$month == "Jul"] = 0.7
run_rose$vjust[run_rose$month == "Jul"] = 2

run_rose$hjust[run_rose$month == "Sep"] = 1.1
run_rose$vjust[run_rose$month == "Sep"] = 0

run_rose$hjust[run_rose$month == "Dec"] = 0.7
run_rose$vjust[run_rose$month == "Dec"] = -1

run_rose$hjust[run_rose$month == "Jan"] = 0.6
run_rose$vjust[run_rose$month == "Jan"] = -1

run_rose$hjust[run_rose$month == "Apr"] = -0.1
run_rose$vjust[run_rose$month == "Apr"] = 0

run_rose$hjust[run_rose$month == "Jun"] = 0.2
run_rose$vjust[run_rose$month == "Jun"] = 4.2
```


```{r, echo=F}
knitr::opts_chunk$set(fig.width = 18, fig.height = 10, fig.align = 'center')
```

```{r run_rose, fig.width = 18, fig.height = 13, fig.align = "center"}
run_rose %>%
  ggplot(aes(x = month, y = total_runs)) + 
  facet_wrap(vars(year), nrow = 1) +
  geom_col(fill = "skyblue", width = 1, col = "black") +
  coord_polar()  +
  scale_y_sqrt() + 
  theme_void() +
  theme(panel.spacing = unit(-10, "lines"),
        strip.text.x = element_blank()) + 
  geom_text(aes(label = label, y = total_runs,
                hjust = hjust, vjust = vjust),
            family =  "Roboto Condensed",
            size = 5,
            position = "identity")
```

---

`r chunk_reveal("run_rose", display_type = "output")`



---
layout: true
`r add_border()`
---

# Modern Nightingales

Who are the modern Florence Nightingales?

[TO READ](https://medium.com/@bituin/9-inspiring-females-in-data-visualization-6bf332185556)
[TO READ](https://medium.com/nightingale/beyond-nightingale-being-a-woman-in-data-visualization-d7968d171ccf)


---

# Amy Cesal

* [Amy Cesal](https://medium.com/nightingale/https-medium-com-data-visualization-society-wedding-data-viz-36e7b9f4787f)

---

# Mona Chalabi


---

# Final words

--

> “We do not want impressions, we want facts. You complain that your report would be dry. The dryer the better. Statistics should be the dryest of all reading.”

-- William Farr, 1861

??? 

Florence realised the power of data.
Observation, reasoning and communication to have impact

RSS moto: Data, Evidence, Decisions

Fortunately, she ignored him.

---
layout: true
`r add_border(inverse=TRUE)`

---

class: center, middle, inverse

# Thank you

* [Slides: bit.ly/flo-data-viz](https://trianglegirl.github.io/presentations/2020-07-01-data-viz-for-better/2020-05-12-florence-and-data-viz.html#1)




